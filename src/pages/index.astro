---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import { get } from "./api/articles";
import type { Article } from "../utils/article.type";
import ProjectCard from "../components/ProjectCard.astro";
import ArticleCard from "../components/ArticleCard.astro";
import EducationCard from "../components/EducationCard.astro";
import CertificateCard from "../components/CertificateCard.astro";
import ExpCard from "../components/ExpCard.astro";
import ContactCard from "../components/ContactCard.astro";

const { articles }: { articles: Article[] } = await (await get()).json();
const projects = (await getCollection("projects")).sort(
  (a, b) => b.data.date - a.data.date
);

const education = (await getCollection("education"))
  .sort((a, b) => b.data.graduation - a.data.graduation)
  .slice(0, 3);
const certicates = (await getCollection("certifications"))
  .sort((a, b) => b.data.obtentionYear - a.data.obtentionYear)
  .slice(0, 3);
const experiences = (await getCollection("experience")).sort(
  (a, b) => b.data.begin - a.data.begin
);
---

<Layout title="Matteo Gassend">
  <div class="w-full space-y-2 lg:space-y-12">
    <section id="about">
      <div class="flex flex-col md:flex-row items-center justify-evenly mt-3">
        <h1 class="text-3xl text-center">Hello, my name is <b>Matteo</b></h1>
      </div>
      <p class="text-center text-xl">
        I am a fullstack developer with {new Date().getFullYear() - 2020} years of
        experience in the industry.
      </p>
    </section>
    <section id="skills"></section>
    <section id="projects">
      <h2 class="section__title mb-4">I worked on things like these</h2>
      <div class="section__grid">
        {
          projects.map((e, idx) => (
            <ProjectCard project={e} side={idx % 2 === 0 ? "left" : "right"} />
          ))
        }
      </div>
    </section>
    <section id="experience">
      <h2 class="section__title">This is where I worked</h2>
      <div class="flex flex-col space-y-8">
        {
          experiences.map((e, idx) => (
            <ExpCard experience={e} side={idx % 2 === 0 ? "left" : "right"} />
          ))
        }
      </div>
    </section>
    <section id="articles">
      <h2 class="section__title">I like to write things from time to time</h2>
      <div class="section__grid">
        {articles.map((e: Article) => <ArticleCard article={e} />)}
      </div>
      <div class="text-center w-full mt-2">
        <a
          class="p-2 border-transparent border-2 hover:border-white transition-[border]"
          href="https://blog.matteogassend.com">Read More Articles</a
        >
      </div>
    </section>
    <section id="education">
      <h2 class="section__title">Here's where I studied</h2>
      <div class="section__grid">
        {education.map((e) => <EducationCard education={e} />)}
      </div>
    </section>
    <section id="certifications">
      <h2 class="section__title">Certificates</h2>
      <div class="flex justify-evenly">
        {certicates.map((e) => <CertificateCard certificate={e} />)}
      </div>
    </section>
    <section id="contact">
      <h2 class="section__title">Reach Out</h2>
      <ContactCard />
    </section>
  </div>
</Layout>

<style>
  .menu__item {
    @apply px-2 py-3;
  }
  .menu__item > a {
    @apply px-2 py-3 hover:-translate-y-2 transform transition-all hover:shadow-md border-transparent border-2 hover:border-white focus:border-blue-300;
  }
  .section__title {
    @apply text-center font-bold text-2xl;
  }
  .section__grid {
    @apply w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8 space-y-6 lg:space-y-8;
  }
</style>
